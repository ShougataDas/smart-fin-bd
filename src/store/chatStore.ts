import { create } from 'zustand';
import { persist, createJSONStorage } from 'zustand/middleware';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { ChatMessage, MessageType } from '@/types';

interface ChatState {
    messages: ChatMessage[];
    isTyping: boolean;
    isLoading: boolean;
    error: string | null;
    conversationId: string | null;
}

interface ChatActions {
    addMessage: (message: Omit<ChatMessage, 'id' | 'timestamp'>) => void;
    sendMessage: (text: string) => Promise<void>;
    clearMessages: () => void;
    setTyping: (isTyping: boolean) => void;
    clearError: () => void;
    generateAIResponse: (userMessage: string) => Promise<string>;
}

type ChatStore = ChatState & ChatActions;

const initialState: ChatState = {
    messages: [],
    isTyping: false,
    isLoading: false,
    error: null,
    conversationId: null,
};

export const useChatStore = create<ChatStore>()(
    persist(
        (set, get) => ({
            ...initialState,

            addMessage: (messageData: Omit<ChatMessage, 'id' | 'timestamp'>) => {
                const newMessage: ChatMessage = {
                    ...messageData,
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    timestamp: new Date(),
                };

                set(state => ({
                    messages: [...state.messages, newMessage],
                }));
            },

            sendMessage: async (text: string) => {
                const { addMessage, generateAIResponse, setTyping } = get();

                // Add user message
                addMessage({
                    userId: 'current_user', // This should come from auth store
                    text,
                    isUser: true,
                    type: MessageType.TEXT,
                });

                // Set typing indicator
                setTyping(true);
                set({ isLoading: true, error: null });

                try {
                    // Generate AI response
                    const aiResponse = await generateAIResponse(text);

                    // Add AI message
                    addMessage({
                        userId: 'ai_assistant',
                        text: aiResponse,
                        isUser: false,
                        type: MessageType.TEXT,
                    });

                } catch (error) {
                    set({
                        error: error instanceof Error ? error.message : 'Failed to get AI response',
                    });

                    // Add error message
                    addMessage({
                        userId: 'ai_assistant',
                        text: '‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶õ‡¶ø ‡¶®‡¶æ‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',
                        isUser: false,
                        type: MessageType.TEXT,
                    });
                } finally {
                    setTyping(false);
                    set({ isLoading: false });
                }
            },

            generateAIResponse: async (userMessage: string): Promise<string> => {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 1000));

                const lowerMessage = userMessage.toLowerCase();

                // Bengali financial advice responses
                if (lowerMessage.includes('‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡¶™‡¶§‡ßç‡¶∞') || lowerMessage.includes('sanchayapatra')) {
                    return `‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡¶™‡¶§‡ßç‡¶∞ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡•§ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶§‡ßá ‡ßÆ.‡ß´% ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∏‡ßÅ‡¶¶ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§ 

‚úÖ **‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ‡¶∏‡¶Æ‡ßÇ‡¶π:**
‚Ä¢ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶ó‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶®‡ßç‡¶ü‡¶ø
‚Ä¢ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶ø‡¶§ ‡¶∏‡ßÅ‡¶¶ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®
‚Ä¢ ‡¶ï‡¶∞ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ (‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£‡ßá)
‚Ä¢ ‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ

üìä **‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶â‡¶™‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶§‡¶æ:** ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶∏‡¶π‡¶®‡¶∂‡ßÄ‡¶≤‡¶§‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶ï‡¶≤‡ßç‡¶™ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§`;
                }

                if (lowerMessage.includes('‡¶Æ‡¶ø‡¶â‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶´‡¶æ‡¶®‡ßç‡¶°') || lowerMessage.includes('mutual fund')) {
                    return `‡¶Æ‡¶ø‡¶â‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶´‡¶æ‡¶®‡ßç‡¶° ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ø‡ßå‡¶• ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ö‡¶®‡ßá‡¶ï ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶∞‡ßá ‡¶™‡ßá‡¶∂‡¶æ‡¶¶‡¶æ‡¶∞ ‡¶´‡¶æ‡¶®‡ßç‡¶° ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞‡¶∞‡¶æ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡ßá‡¶®‡•§

üí∞ **‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶ø‡¶§ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®:** ‡ßß‡ß®-‡ßß‡ß´% (‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ)
üéØ **‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó:** ‡ß´,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ

**‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:**
‚Ä¢ ‡¶™‡ßá‡¶∂‡¶æ‡¶¶‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ
‚Ä¢ ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ú‡¶®
‚Ä¢ ‡¶§‡¶∞‡¶≤‡¶§‡¶æ (‡¶∏‡¶π‡¶ú‡ßá ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶Ø‡¶º)
‚Ä¢ ‡¶∏‡ßç‡¶¨‡¶ö‡ßç‡¶õ‡¶§‡¶æ

**‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø:** ‡¶Æ‡¶æ‡¶ù‡¶æ‡¶∞‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶â‡¶ö‡ßç‡¶ö (‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶∂‡ßÄ‡¶≤)`;
                }

                if (lowerMessage.includes('‡¶∏‡ßç‡¶ü‡¶ï') || lowerMessage.includes('stock') || lowerMessage.includes('‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞')) {
                    return `‡¶∏‡ßç‡¶ü‡¶ï ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡ßá‡¶ü‡ßá ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶â‡¶ö‡ßç‡¶ö ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡¶æ ‡¶∞‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶§‡¶¨‡ßá ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶ì ‡¶¨‡ßá‡¶∂‡¶ø‡•§

üöÄ **‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®:** ‡ßß‡ß´-‡ß®‡ß´% (‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶‡ßá)
‚ö†Ô∏è **‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø:** ‡¶â‡¶ö‡ßç‡¶ö

**‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ü‡¶ø‡¶™‡¶∏:**
‡ßß. ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
‡ß®. ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡¶Æ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
‡ß©. ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶‡ßÄ ‡¶¶‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø‡¶≠‡¶ô‡ßç‡¶ó‡¶ø ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®
‡ß™. ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶ó‡¶¨‡ßá‡¶∑‡¶£‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
‡ß´. ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶∏‡ßá‡¶ï‡ßç‡¶ü‡¶∞‡ßá ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®

**‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞‡¶ø‡¶∂:** ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶´‡ßã‡¶≤‡¶ø‡¶ì‡¶∞ ‡ß®‡ß¶-‡ß©‡ß¶% ‡¶∏‡ßç‡¶ü‡¶ï‡ßá ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§`;
                }

                if (lowerMessage.includes('dps') || lowerMessage.includes('‡¶°‡¶ø‡¶™‡¶ø‡¶è‡¶∏')) {
                    return `DPS (Deposit Pension Scheme) ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶‡ßÄ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ‡•§

üíµ **‡¶¨‡ßà‡¶∂‡¶ø‡¶∑‡ßç‡¶ü‡ßç‡¶Ø:**
‚Ä¢ ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶ú‡¶Æ‡¶æ
‚Ä¢ ‡ß´-‡ß®‡ß¶ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶
‚Ä¢ ‡ß≠-‡ßÆ% ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶∏‡ßÅ‡¶¶
‚Ä¢ ‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ

**‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:**
‚Ä¢ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶ø‡¶§ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ö‡¶≠‡ßç‡¶Ø‡¶æ‡¶∏
‚Ä¢ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó
‚Ä¢ ‡¶™‡ßá‡¶®‡¶∂‡¶® ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ
‚Ä¢ ‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ/‡¶Æ‡¶æ‡¶∏

**‡¶â‡¶™‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶§‡¶æ:** ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶ø‡¶§ ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶¨‡¶∏‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞‡•§`;
                }

                if (lowerMessage.includes('‡¶¨‡¶Ø‡¶º‡¶∏') || lowerMessage.includes('age') || lowerMessage.includes('‡¶ï‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ')) {
                    return `‡¶¨‡¶Ø‡¶º‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ:

üìà **‡¶¨‡¶Ø‡¶º‡¶∏ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶ó‡¶æ‡¶á‡¶°:**
‚Ä¢ ‡ß®‡ß¶-‡ß©‡ß¶ ‡¶¨‡¶õ‡¶∞: ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡ß®‡ß¶-‡ß©‡ß¶%
‚Ä¢ ‡ß©‡ß¶-‡ß™‡ß¶ ‡¶¨‡¶õ‡¶∞: ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡ß©‡ß¶-‡ß™‡ß¶%
‚Ä¢ ‡ß™‡ß¶-‡ß´‡ß¶ ‡¶¨‡¶õ‡¶∞: ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡ß™‡ß¶-‡ß´‡ß¶%
‚Ä¢ ‡ß´‡ß¶+ ‡¶¨‡¶õ‡¶∞: ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡ß´‡ß¶%+

**‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶§‡¶π‡¶¨‡¶ø‡¶≤:** ‡ß¨-‡ßß‡ß® ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶®

**‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ú‡¶® (‡¶¨‡¶Ø‡¶º‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ):**
‚Ä¢ ‡¶§‡¶∞‡ßÅ‡¶£ ‡¶¨‡¶Ø‡¶º‡¶∏: ‡ß≠‡ß¶% ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£, ‡ß©‡ß¶% ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶
‚Ä¢ ‡¶Æ‡¶ß‡ßç‡¶Ø ‡¶¨‡¶Ø‡¶º‡¶∏: ‡ß´‡ß¶% ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£, ‡ß´‡ß¶% ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶
‚Ä¢ ‡¶¨‡¶Ø‡¶º‡¶∏‡ßç‡¶ï: ‡ß©‡ß¶% ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£, ‡ß≠‡ß¶% ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶`;
                }

                if (lowerMessage.includes('‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø') || lowerMessage.includes('goal') || lowerMessage.includes('‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ')) {
                    return `‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡ßÅ‡¶¨‡¶á ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡•§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶ï‡¶∞ ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø:

üéØ **SMART ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£:**
‚Ä¢ **S**pecific (‡¶∏‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü)
‚Ä¢ **M**easurable (‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶™‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø)
‚Ä¢ **A**chievable (‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø)
‚Ä¢ **R**elevant (‡¶™‡ßç‡¶∞‡¶æ‡¶∏‡¶ô‡ßç‡¶ó‡¶ø‡¶ï)
‚Ä¢ **T**ime-bound (‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ)

**‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø‡¶∏‡¶Æ‡ßÇ‡¶π:**
‡ßß. ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶§‡¶π‡¶¨‡¶ø‡¶≤ (‡ß¨ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶ñ‡¶∞‡¶ö)
‡ß®. ‡¶¨‡¶æ‡¶°‡¶º‡¶ø ‡¶ï‡ßá‡¶®‡¶æ
‡ß©. ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ
‡ß™. ‡¶Ö‡¶¨‡¶∏‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ
‡ß´. ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ

**‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂:** ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`;
                }

                // Default response for general queries
                return `‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶¨‡¶á ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡•§ ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡•§

ü§ù **‡¶Ü‡¶Æ‡¶ø ‡¶Ø‡ßá‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø:**
‚Ä¢ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂
‚Ä¢ ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®
‚Ä¢ ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ
‚Ä¢ ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶ï‡ßå‡¶∂‡¶≤
‚Ä¢ ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£

‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶Ø‡¶º‡¶∏, ‡¶Ü‡¶Ø‡¶º, ‡¶è‡¶¨‡¶Ç ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶∞‡¶ì ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡•§ 

üí° **‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂:** ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡¶æ‡¶§‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶∞‡¶ì ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§‡¶ï‡ßÉ‡¶§ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡•§

‡¶Ü‡¶∞‡¶ì ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®!`;
            },

            clearMessages: () => {
                set({ messages: [] });
            },

            setTyping: (isTyping: boolean) => {
                set({ isTyping });
            },

            clearError: () => {
                set({ error: null });
            },
        }),
        {
            name: 'chat-storage',
            storage: createJSONStorage(() => AsyncStorage),
            partialize: (state) => ({
                messages: state.messages.slice(-50), // Keep only last 50 messages
                conversationId: state.conversationId,
            }),
        }
    )
);

